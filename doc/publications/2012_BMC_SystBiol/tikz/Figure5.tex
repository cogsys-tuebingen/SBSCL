\documentclass{article}

\usepackage[latin1]{inputenc}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows}
\begin{document}
\pagestyle{empty}


% Define block styles
\tikzstyle{decision} = [diamond, draw, fill=blue!20, 
    text width=4.5em, text badly centered, node distance=3cm, inner sep=0pt]
\tikzstyle{block} = [rectangle, draw, fill=blue!20, 
    text width=8em, text centered, minimum height=4em]
\tikzstyle{line} = [draw, -latex']
\tikzstyle{cloud} = [draw, ellipse,fill=red!20, node distance=3cm,
    minimum height=2em]
\tikzstyle{io} = [trapezium,trapezium left angle=70,trapezium right angle=-70,minimum height=0.6cm, draw, fill=blue!20, 
text width=14em, text badly centered, node distance=2.5cm, inner sep=4pt,minimum height=2em]
\tikzstyle{blank} = [coordinate]%[rectangle, text width=0em, text centered, rounded corners, minimum height=0em]

    
\begin{tikzpicture}[node distance = 2cm, auto]
    % Place nodes
	\node [cloud] (start) {Start};
	\node [block, below of=start] (init) {$t:=t_{begin}$\qquad $\vec{Q}:=\vec{Q}_{begin}$ \quad $s:=s_0$};
	\node [io, below of=init] (output) {($\vec{Q}_{res}$, $t_{res}$):=Rosenbrock(t, $\vec{Q}$, s)};
	\node [block, below of=output,text width=17em] (pevents) {$\vec{Q}_p$:=\\ProcessEventsAndRules($\vec{Q}_{res}, t_{res}$)};
	\node [decision, below of=pevents, node distance=3cm] (xpxres?) {$\vec{Q}_p=\vec{Q}_{res}?$};
	\node [block, left of=xpxres?, below of=xpxres?, node distance=4cm] (newvalues) {$t:=t_{res}$ \qquad $\vec{Q}:=\vec{Q}_{res}$ \qquad $s:=adapt(s)$ };
	\node [decision, right of=xpxres?, node distance=3.5cm] (larger?) {$s\ge s_{min} \cdot 10$};
	\node [block, right of=larger?, node distance=3.5cm] (stepsize) {$s:= \frac{s}{10}$};

	\node [decision, below of=newvalues, node distance=3cm] (end?) {$t \ge t_{end}$};
	\node [cloud, below of=end?, node distance=2.5cm] (stop) {Stop};
	\node [blank, left of=newvalues] (aux){};
	\node [blank, left of=xpxres?] (aux2){};

%	\node [decision, below of=findpaths] (matching?) {At least one path available?};
%	\node [block, left of=matching?, node distance=4.5cm] (augment) {Augment matching};
%	\node [decision, below of=matching?, node distance=3.5cm] (overdetermined?) {Model ovedetermined?};
%	\node [block, below of=overdetermined?, node distance=3cm] (i0) {i:=0};
%	\node [block, right of=overdetermined?, node distance=4.5cm] (exception) {Throw exception};
%	\node [block, below of=i0, node distance=2.5cm] (solve) {Solve i-th algebraic rule according to matching};
%	\node [block, left of=solve, node distance=4.5cm] (i++) {i:=i+1};
%	\node [io, below of=solve, node distance=2cm] (newassignment) {New assignment rule};
%
%	\node [decision, below of=newassignment, node distance=2cm] (rulesleft?) {i=\#algebraic rules?};
%	\node [cloud, below of=rulesleft?, node distance=2.5cm] (stop) {Stop};


	\path [line] (start) -- (init);
	\path [line] (init) -- (output);
	\path [line] (output) -- (pevents);
	\path [line] (pevents) -- (xpxres?);
	\path [line] (xpxres?) -- node {Yes}(aux2)-| (newvalues);
	\path [line] (xpxres?) -- node {No}(larger?);
	\path [line] (larger?) |- node {No}(newvalues);
	\path [line] (larger?) -- node {Yes}(stepsize);
	\path [line] (stepsize) |- (output);
	\path [line] (newvalues) -- (end?);
	\path [line] (end?) -- node {Yes}(stop);
	\path [line] (end?) -| (aux) |- node {No}(output);



%\path [line] (end?) |- node {No})([xshift=-0.5cm,yshift=-0.5cm]newvalues.south west) |- (init);
%	\path [line] (findpaths) -- (matching?);
%	\path [line] (matching?) -- node {Yes}(augment);		
%	\path [line] (augment) |- (findpaths);
%	\path [line] (matching?) -- node {No} (overdetermined?);
%	\path [line] (overdetermined?) -- node {No} (i0);
%	\path [line] (overdetermined?) -- node {Yes}(exception);
%	\path [line] (i0) -- (solve);
	%\path [line] (i++) -- (solve);
%	\path [line] (solve) -- (newassignment);

	%\path [line] (newassignment) -- (rulesleft?);
	%\path [line] (rulesleft?) -| node {No} (i++);
	%\path [line] (rulesleft?) -- node {Yes} (stop);
	%\path [line] (exception) |- (stop);

\end{tikzpicture}


\end{document}